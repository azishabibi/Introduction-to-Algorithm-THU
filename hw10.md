# <center>Homework10

##### <center>刘喆骐     2020013163    探微化01

## 32.4-8
$\qquad$首先证明判定方法：若$q=m$或$P[q+1]\not =a$，则$\delta (q,a)=\delta (\pi [q],a)$，否则$q=q+1$.若$q=m$，则说明匹配成功，接下来模板应该舍弃该段的一部分而后移，利用$q=\pi [q]$来决策后移量。若$P[q+1]\not =a$，说明下一个字符不匹配，也需要后移，$q=\pi [q]$。而当$q\not =m$且$P[q+1]=a$的时候，说明下一位匹配，后移一位即可。
$\qquad$于是可以按照如下方法求解$\delta$：
```
calculate_delta(P,sigma):
    m=P.size()
    π[1]=0
    k=0
    for q=2 to m:
        while k>0 and P[k+1]!=P[q]:
            k=π[k]
        if P[k+1]==P[q]:
            k=k+1
        π[q]=k

    let δ[1...m][|sigma|] be a new array
    for a in sigma:
        δ[1][a]=0
    k=0
    for q=2 to m:
        for a in sigma:
            while k>0 and (P[k+1]!=a or q==m):
                k=π[k]
            if P[k+1]==a:
                k=k+1
            δ[q][a]=k

    return δ
```
时间复杂度为外层的m乘上内层的$\Sigma$，为$O(m|\Sigma|)$